<!DOCTYPE html>
<html lang="en">

<head>
    <title>NLDB</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
    <style>
        th {
            text-align: left;
            background-color: aquamarine;
            padding: 5px;
        }

        table {
            border-spacing: 0 0.3em;
        }

        td {
            padding-top: 4px;
        }

        .light-green {
            color: aquamarine;
        }
    </style>
</head>

<body class="w-100 avenir black-80 bg-pink">
    <div id="app" class="mw7 center">
        <form @submit="formSubmit" class="pa2 black-80">
            <div>
                <h1 class="f-subheadline-ns f1 lh-solid mb4 near-black"><span class="light-green">Co</span>Da</h1>
                <label for="question" class="f4 db mb3">Your question:</label>
                <input id="question" class="input-reset f4 ba b--black-20 pa2 mb1 db w-100 br2" type="text"
                    v-model.lazy="question">
                <!-- <textarea id="question" name="question"
                    class="db border-box hover-black w-100 f4 ba b--black-20 pa2 br2 mb2"
                    v-model.lazy="question"></textarea> -->
                <input id="submit" class="dim mt3 pointer ph3 pv2 input-reset ba b--black br2 bg-transparent f4 mb3"
                    type="submit" :value="button_text">
                <span class="mt1 code f5" v-html="answer"></span>

            </div>
        </form>
    </div>

    <script>
        var app = new Vue({
            el: '#app',
            data: {
                question: '',
                answer: '',
                tokens: 0,
                cost: 0,
                duration: [],
                sql: '',
                button_text: 'Tell me',
                display: false,
            },
            methods: {
                formSubmit(e) {
                    e.preventDefault();
                    app.button_text = "Hold tight...";
                    api_url = "/api/ask?q=" + app.question;
                    axios.get(api_url)
                        .then(function (response) {
                            app.answer = response.data['response']['answer'];
                            app.tokens = response.data['response']['tokens'];
                            app.sql = response.data['response']['sql'];
                            app.cost = response.data['response']['cost'];
                            app.duration = response.data['response']['duration'];
                            app.button_text = "Tell me";
                            console.log('Tokens: ', app.tokens);
                            console.log('Cost: $', app.cost);
                            console.log('SQL: ', app.sql);
                            console.log('Duration: ', app.duration);
                        })
                        .catch(function (error) {
                            console.log(error);
                        });
                },
            }
        })
    </script>
</body>

</html>